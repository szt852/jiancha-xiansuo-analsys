# 劳动监察线索表格汇聚和统计工具

本工具是一个用于劳动监察线索数据处理的Web应用，能够读取并处理"12345数据"和"安薪在线数据"两个Excel表格，生成劳动监察线索汇总表和数据情况统计表。

## 功能特点

- 上传"12345数据"和"安薪在线数据"Excel表格
- 自动汇聚两个数据源，生成劳动监察线索汇总表
- 基于汇总表生成劳动监察线索数据情况统计表
- 支持导出Excel格式的汇总和统计结果
- 友好的用户界面和操作指引

## 技术栈

- 后端: Python + FastAPI
- 前端: HTML, CSS (Bootstrap), JavaScript
- 数据处理: Pandas

## 安装和运行

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 运行应用

```bash
python main.py
```

或者使用uvicorn直接运行：

```bash
uvicorn main:app --reload
```

### 3. 访问应用

打开浏览器，访问 http://localhost:8000

## 使用说明

1. 在主页面上传"12345数据"和"安薪在线数据"两个Excel文件
2. 点击"处理并下载汇总表"按钮
3. 系统将自动处理数据并生成包含汇总表和统计表的Excel文件
4. 文件将自动下载到您的计算机，文件名格式为"YYYYMMDD劳动监察线索汇总和统计.xlsx"

## 数据要求

### 12345数据表要求的字段
- 序号
- 流水号
- 紧急程度
- 事件来源
- 诉求人
- 诉求人电话
- 诉求标题
- 诉求内容
- 所属区域
- 所涉领域
- 是否涉稳
- 所涉行业
- 所涉项目（企业）
- 项目性质
- 是否在监管系统中
- 项目状态
- 建设单位
- 总包单位
- 涉及人数
- 涉及金额
- 是否再次投诉

### 安薪在线数据表要求的字段
- 项目名称
- 行业
- 建设单位
- 施工单位
- 项目经理
- 联系电话
- 区域
- 预警类型
- 预警原因
- 预警时间
- 状态
- 预警天数

## 输出文件说明

### YYYYMMDD劳动监察线索汇总表
包含两个数据源的所有字段，并进行了字段映射和标准化处理。

### YYYYMMDD劳动监察线索数据情况统计表
根据汇总表生成的统计信息，包括各区域、各领域的线索数量、预警情况和欠薪点位等。

## 注意事项

- 请确保上传的Excel文件格式正确，包含所需的所有字段
- 文件大小建议不超过10MB
- 区域名称将自动标准化处理
- 处理时间取决于数据量大小